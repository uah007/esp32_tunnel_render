# ESP32 NAT Tunnel - ะะตัะฟะปะฐัะฝัะน ะพะฑะปะฐัะฝัะน ัะตัะฒะธั

> ะัะพะทัะฐัะฝัะน TCP ััะฝะฝะตะปั ะดะปั ะดะพัััะฟะฐ ะบ ััััะพะนััะฒะฐะผ ะทะฐ NAT ัะตัะตะท ESP32 ะผะพัั

## ๐ฏ ะงัะพ ััะพ?

ะะตัะตะฝะธะต ะดะปั ะดะพัััะฟะฐ ะบ ะฒะตะฑ-ะธะฝัะตััะตะนัะฐะผ ััััะพะนััะฒ ะฒ ะปะพะบะฐะปัะฝะพะน ัะตัะธ (ัะพััะตัั, ESP32, ะบะฐะผะตัั) ัะตัะตะท ะธะฝัะตัะฝะตั **ะฑะตะท ะฑะตะปะพะณะพ IP ะฐะดัะตัะฐ** ะธ **ะฟะพะปะฝะพัััั ะฑะตัะฟะปะฐัะฝะพ**.

### ะะฐะบ ััะพ ัะฐะฑะพัะฐะตั:

```
[ะะฐั ะะ] โ [ะะฑะปะฐัะฝัะน ัะตัะฒะตั] โ [ESP32 ะฒ ัะดะฐะปะตะฝะฝะพะน ัะตัะธ] โ [ะฆะตะปะตะฒะพะต ััััะพะนััะฒะพ]
```

1. **ESP32-ะผะพัั** ะฝะฐัะพะดะธััั ะฒ ัะดะฐะปะตะฝะฝะพะน ะปะพะบะฐะปัะฝะพะน ัะตัะธ (ะณะดะต ัะตะปะตะฒะพะต ััััะพะนััะฒะพ)
2. **ะะฑะปะฐัะฝัะน ัะตัะฒะตั** ะฝะฐ Render.com ัะฐะฑะพัะฐะตั 24/7 ะฑะตัะฟะปะฐัะฝะพ
3. **MQTT** ะธัะฟะพะปัะทัะตััั ะดะปั ะฟะตัะตะดะฐัะธ ะบะพะผะฐะฝะด ESP32
4. **WebSocket** ะพะฑะตัะฟะตัะธะฒะฐะตั ะดะฒัััะพัะพะฝะฝัั ัะฒัะทั

## โจ ะัะพะฑะตะฝะฝะพััะธ

- โ **ะะพะปะฝะพัััั ะฑะตัะฟะปะฐัะฝะพ** - Render.com + UptimeRobot
- โ **ะะตะท ะฑะตะปะพะณะพ IP** - ัะฐะฑะพัะฐะตั ะทะฐ ะปัะฑัะผ NAT
- โ **ะัะพะทัะฐัะฝัะน TCP ััะฝะฝะตะปั** - ัะฐะฑะพัะฐะตั ั ะปัะฑัะผะธ HTTP ััััะพะนััะฒะฐะผะธ
- โ **ะะตะทะพะฟะฐัะฝะพ** - ัะธััะพะฒะฐะฝะธะต ัะตัะตะท WSS (TLS)
- โ **ะะตะณะบะธะน ะดะตะฟะปะพะน** - GitHub โ Render.com ะทะฐ 2 ะผะธะฝััั
- โ **ะะธะทะตัะฝัะน ััะฐัะธะบ** - ะฟะพะดัะพะดะธั ะดะปั ะฑะตัะฟะปะฐัะฝัั ัะฐัะธัะพะฒ

## ๐ฆ ะะพะผะฟะพะฝะตะฝัั ะฟัะพะตะบัะฐ

### 1. ะะฑะปะฐัะฝัะน ัะตัะฒะตั (Node.js)
- **server_websocket.js** - WebSocket ัะตัะฒะตั ะดะปั relay
- ะะตะฟะปะพะธััั ะฝะฐ Render.com ะฑะตัะฟะปะฐัะฝะพ
- ะะฐะฑะพัะฐะตั 24/7 ั UptimeRobot

### 2. ESP32 ะผะพัั
- **esp32_websocket.ino** - ะบะพะด ะดะปั ESP32
- ะะพะดะบะปััะฐะตััั ะบ MQTT ะธ WebSocket
- ะขัะฝะฝะตะปะธััะตั ััะฐัะธะบ ะบ ัะตะปะตะฒะพะผั ััััะพะนััะฒั

### 3. ะะปะธะตะฝั (ะพะฟัะธะพะฝะฐะปัะฝะพ)
- **Python GUI** - ะดะปั ัะฟัะฐะฒะปะตะฝะธั ัะตัะตะท MQTT
- **ะะตะฑ-ะธะฝัะตััะตะนั** - ะฟััะผะพะน ะดะพัััะฟ ัะตัะตะท ะฑัะฐัะทะตั

## ๐ ะัััััะน ััะฐัั

### ะจะฐะณ 1: ะะตะฟะปะพะน ัะตัะฒะตัะฐ (2 ะผะธะฝ)

1. ะคะพัะบะฝะธัะต ััะพั ัะตะฟะพะทะธัะพัะธะน
2. ะะฐะนะดะธัะต ะฝะฐ [render.com](https://render.com)
3. New Web Service โ ะฒัะฑะตัะธัะต ะฒะฐั fork
4. Deploy (ะธัะฟะพะปัะทัะนัะต ะฑะตัะฟะปะฐัะฝัะน ะฟะปะฐะฝ)

### ะจะฐะณ 2: UptimeRobot (1 ะผะธะฝ)

1. ะะฐะนะดะธัะต ะฝะฐ [uptimerobot.com](https://uptimerobot.com)
2. Add Monitor โ ัะธะฟ HTTP(s)
3. URL: `https://ะฒะฐั-ัะตัะฒะธั.onrender.com/health`
4. Interval: 5 minutes

### ะจะฐะณ 3: ESP32 (5 ะผะธะฝ)

1. ะฃััะฐะฝะพะฒะธัะต ะฑะธะฑะปะธะพัะตะบะธ Arduino:
   - PubSubClient
   - ArduinoJson  
   - arduinoWebSockets

2. ะะฐะณััะทะธัะต `esp32_websocket.ino`

3. ะะฐัััะพะนัะต WiFi ะธ MQTT

4. ะัะฟัะฐะฒััะต MQTT ะบะพะผะฐะฝะดั:
```
your-service.onrender.com,443,192.168.1.100,80
```

### ะะพัะพะฒะพ! ๐

ะัะบัะพะนัะต: `https://your-service.onrender.com/?tunnel=any_id`

## ๐ ะะพะบัะผะตะฝัะฐัะธั

- **[QUICK_START.md](QUICK_START.md)** - ะบัะฐัะบะพะต ััะบะพะฒะพะดััะฒะพ
- **[RENDER_DEPLOY.md](RENDER_DEPLOY.md)** - ะฟะพะปะฝะฐั ะธะฝััััะบัะธั ะดะตะฟะปะพั
- **[API.md](#)** - ะพะฟะธัะฐะฝะธะต ะฟัะพัะพะบะพะปะฐ WebSocket (TODO)

## ๐ก ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### 1. ะะพัััะฟ ะบ ัะพััะตัั ะฑะตะท ะฑะตะปะพะณะพ IP
```mqtt
your-service.onrender.com,443,192.168.1.1,80
```

### 2. ะฃะฟัะฐะฒะปะตะฝะธะต ESP32 ััััะพะนััะฒะพะผ
```mqtt
your-service.onrender.com,443,192.168.1.150,80
```

### 3. ะัะพัะผะพัั IP ะบะฐะผะตัั
```mqtt
your-service.onrender.com,443,192.168.1.200,8080
```

## ๐ง ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโ                    โโโโโโโโโโโโโโโโโโโ
โ             โ                    โ                 โ
โ  Python GUI โโโโโโโโMQTTโโโโโโโโโบโ     ESP32       โ
โ             โ                    โ     (bridge)    โ
โโโโโโโโฌโโโโโโโ                    โโโโโโโโโโฌโโโโโโโโโ
       โ                                    โ
       โ                                    โ
       โ          WebSocket (WSS)           โ
       โ         โโโโโโโโโโโโโโโโ           โ
       โโโโโโโโโโบโ              โโโโโโโโโโโโโ
                 โ Render.com   โ
                 โ  (Node.js)   โ
                 โโโโโโโโโโโโโโโโ
                        โ
                        โ Local TCP
                        โผ
                 โโโโโโโโโโโโโโโโ
                 โ   Target     โ
                 โ   Device     โ
                 โ 192.168.x.x  โ
                 โโโโโโโโโโโโโโโโ
```

## ๐ฐ ะกัะพะธะผะพััั

| ะกะตัะฒะธั | ะะปะฐะฝ | ะฆะตะฝะฐ |
|--------|------|------|
| Render.com | Free tier | $0 |
| UptimeRobot | Free | $0 |
| MQTT broker | Public | $0 |
| **ะะขะะะ** | | **$0/ะผะตััั** |

## ๐ ะขะตัะฝะพะปะพะณะธะธ

- **Backend**: Node.js, WebSocket (ws)
- **ESP32**: Arduino, WebSocket, MQTT
- **Cloud**: Render.com
- **Monitoring**: UptimeRobot
- **Protocol**: WebSocket over TLS (WSS)

## ๐ ะะตะทะพะฟะฐัะฝะพััั

- โ TLS ัะธััะพะฒะฐะฝะธะต (WSS)
- โ Tunnel ID ะดะปั ะธะทะพะปััะธะธ ัะตััะธะน
- โ๏ธ ะะฐะทะพะฒะฐั ะฒะตััะธั - ะฝะตั ะฐััะตะฝัะธัะธะบะฐัะธะธ
- ๐ก TODO: ะดะพะฑะฐะฒะธัั ะฟะฐัะพะปะธ ะดะปั tunnel

## ๐ ะคะพัะผะฐั MQTT ะบะพะผะฐะฝะดั

```
ัะตัะฒะตั,ะฟะพัั_ะฒะตะฑัะพะบะตัะฐ,IP_ัะตะปะตะฒะพะณะพ,ะฟะพัั_ัะตะปะตะฒะพะณะพ
```

**ะะปั Render.com (ะฒัะตะณะดะฐ ะฟะพัั 443):**
```
my-tunnel.onrender.com,443,192.168.1.254,80
```

**ะะปั ะปะพะบะฐะปัะฝะพะณะพ ัะตััะธัะพะฒะฐะฝะธั:**
```
localhost,8080,192.168.1.254,80
```

## ๐ Troubleshooting

### ะกะตัะฒะตั ะทะฐััะฟะฐะตั
โ ะะฐัััะพะนัะต UptimeRobot ะฝะฐ ะฟะธะฝะณ ะบะฐะถะดัะต 5 ะผะธะฝัั

### ESP32 ะฝะต ะฟะพะดะบะปััะฐะตััั
โ ะัะพะฒะตัััะต ะฟะพัั 443 ะธ ะฑะธะฑะปะธะพัะตะบั arduinoWebSockets

### ะะตั ะดะพัััะฟะฐ ะบ ััััะพะนััะฒั
โ ะัะพะฒะตัััะต ะปะพะบะฐะปัะฝัะน IP ะธ ะดะพัััะฟะฝะพััั ะฒ ัะตัะธ ESP32

## ๐ค Contributing

Pull requests ะฟัะธะฒะตัััะฒััััั!

TODO:
- [ ] ะััะตะฝัะธัะธะบะฐัะธั (ะฟะฐัะพะปะธ)
- [ ] ะะฝะพะถะตััะฒะตะฝะฝัะต ััะฝะฝะตะปะธ
- [ ] ะะตะฑ UI ะดะปั ัะฟัะฐะฒะปะตะฝะธั
- [ ] ะะตััะธะบะธ ะธ ััะฐัะธััะธะบะฐ
- [ ] Docker ะพะฑัะฐะท ะดะปั self-hosting

## ๐ ะะธัะตะฝะทะธั

MIT License - ะธัะฟะพะปัะทัะนัะต ัะฒะพะฑะพะดะฝะพ!

## ๐จโ๐ป ะะฒัะพั

ะกะพะทะดะฐะฝะพ ะดะปั ัะตัะตะฝะธั ะฟัะพะฑะปะตะผั ะดะพัััะฟะฐ ะบ ััััะพะนััะฒะฐะผ ะทะฐ NAT ะฑะตะท VPN ะธ ะฑะตะปะพะณะพ IP.

---

โญ ะัะปะธ ะฟัะพะตะบั ะฟะพะผะพะณ - ะฟะพััะฐะฒััะต ะทะฒะตะทะดั!
